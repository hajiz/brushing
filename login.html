<html>
<head>
<title>Enter brushing app</title>
<style>
body {
	margin: 50px;
}
h1 {
	text-align:center;
}

div#create, div#join {
	position: relative;
	left: 25%;
	text-align: center;
	border: 2px blue solid;
	background-color: steelblue;
	color: white;
	border-radius: 5px;
	width: 50%;
	padding: 20px;
}

span.label {
	display: inline-block;
	width: 150px;
	text-align: right;
	padding-right: 10px;
}

input, select {
	width: 300px;
}

button {
	margin-top: 30px;
}
</style>
<script src="jquery.js"></script>
<script type="text/javascript">
var datasets = {"efashion":"Fashion", "shopping":"Shopping Center"};
var my_id = -1;
var my_dataset = '';
$(document).ready (function () {
	$("create [name='dataset']").html("");
	$.each(Object.keys(datasets), function (i, v) { $("#create [name='dataset']").append("<option value='" + v + "'>" + datasets[v] + "</option>"); });
	fill_sessions ()
	$("#create_btn").click(function () {
		var name = $('#create [name="sessionname"]').val();
		if (name.length < 1) {
			alert('You should enter a name for the session');
			return;
		}
		var dataset = $('#create [name="dataset"]').val();
		$.ajax('http://142.104.68.169/server/brushing/createsession.php?name=' + name + '&dataset=' + dataset, 
			{
				"success": function (data) { if (data.length != 0) alert("failure with error: " + data); }
			});
		fill_sessions();
	});
	
	$("#join_btn").click(function () {
		var name = $('#join [name="name"]').val();
		if (name.length < 1) {
			alert('Enter your name please');
			return;
		}
		var session = $('#join [name="session"]').val();
		if (session == null || session.length < 1) {
			alert('First create a session');
			return;<option value="efashion">Fashion</option>
		}
		$.ajax('../../server/brushing/joinsession.php?name=' + name + '&session=' + session, 
			{ "dataType":"json", "success": function (data) { my_id = data.id; my_dataset = data.dataset; } });
		$("#login").html("");
	});
});

function fill_sessions () {
	$("#join [name='session']").html("");
	$.ajax('../../server/brushing/listsession.php', 
		{ "dataType":"json", "success": function (data) { $.each(data, function (i, v) { $("#join [name='session']").append("<option value='" + v.id + "'>" + v.name + " (" + datasets[v.dataset] + ")</option>"); }); } });
}
</script>
</head>

<body>
<div id="login">
<div id="create">
<h1>Create a new session</h1>
<span class="label">Session Name:</span><input name="sessionname" /><br/>
<span class="label">Dataset:</span><select name="dataset">
</select><br/>
<button id="create_btn">Create</button>
</div>
<h1>or</h1>
<div id="join">
<h1>Join an existing one</h1>
<span class="label">Name:</span><input name="name" /><br/>
<span class="label">Session Name:</span><select name="session">
<!-- sample <option value="1">test</option>-->
</select><br/>
<button id="join_btn">Join</button>
</div>
</div>
</body>
</html>